(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{da01:function(a,e,o){"use strict";o.r(e);var t=function(){var a=this,e=a.$createElement,o=a._self._c||e;return o("q-page",{staticClass:"row q-pa-lg "},[o("div",{staticClass:"col-lg-8 col-md-8 col-sm-12 col-12 q-pa-lg"},[o("q-card",{staticClass:" q-ma-sm"},[o("q-card-section",{staticClass:"flex"},[o("div",{staticClass:"text-h5"},[a._v("Mi cuenta")]),o("q-space"),o("q-icon",{staticClass:"cursor-pointer",staticStyle:{"font-size":"2em"},attrs:{name:"info",color:"secondary"}},[o("q-tooltip",{attrs:{"content-class":"bg-purple","content-style":"font-size: 13px",offset:[10,10]}},[a._v("\n            Para editar la informacion, modifica el campo que quieras modificar y despues pulsa 'Guardar'\n          ")])],1)],1),o("q-separator"),o("q-card-section",[o("div",{staticClass:"text-h6 text-grey-6"},[a._v("Informacion del usuario")]),o("div",{staticClass:"row"},[o("q-input",{staticClass:"q-pa-sm col-lg-4 col-md-4 col-sm-4 col-12",attrs:{outlined:"",label:"Nombre",placeholder:"John",color:"secondary"},model:{value:a.usuario.nombre,callback:function(e){a.$set(a.usuario,"nombre",e)},expression:"usuario.nombre"}}),o("q-input",{staticClass:"q-pa-sm col-lg-6 col-md-6 col-sm-6 col-12",attrs:{outlined:"",label:"Apellidos",placeholder:"Doe",color:"secondary"},model:{value:a.usuario.apellidos,callback:function(e){a.$set(a.usuario,"apellidos",e)},expression:"usuario.apellidos"}})],1),o("div",{staticClass:"row"},[o("q-input",{staticClass:"q-pa-sm col-lg-5 col-md-5 col-sm-10 col-12",attrs:{"input-class":"text-grey-6",outlined:"",type:"email",label:"Email",readonly:"",color:"secondary"},scopedSlots:a._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"far fa-envelope"}})]},proxy:!0}]),model:{value:a.usuario.email,callback:function(e){a.$set(a.usuario,"email",e)},expression:"usuario.email"}},[o("q-tooltip",{staticClass:"justify-center",attrs:{"content-class":"bg-red-9 content-center","content-style":"font-size: 0.9em",delay:500,offset:[0,5]}},[o("q-icon",{attrs:{name:"fas fa-exclamation-circle",size:"0.9em"}}),a._v("\n              Correo electronico no modificable\n            ")],1)],1),o("q-input",{staticClass:"col-lg-3 col-md-3 col-sm-5 col-12 q-pa-sm",attrs:{outlined:"",mask:"####/##/##",label:"Fecha de nacimiento",color:"secondary"},on:{click:function(){return a.$refs.qDateProxy.show()}},scopedSlots:a._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[o("q-popup-proxy",{ref:"qDateProxy"},[o("q-date",{attrs:{color:"accent","first-day-of-week":"1"},on:{input:function(){return a.$refs.qDateProxy.hide()}},model:{value:a.usuario.dataNacimiento,callback:function(e){a.$set(a.usuario,"dataNacimiento",e)},expression:"usuario.dataNacimiento"}})],1)],1)]},proxy:!0}]),model:{value:a.usuario.dataNacimiento,callback:function(e){a.$set(a.usuario,"dataNacimiento",e)},expression:"usuario.dataNacimiento"}},[o("q-tooltip",{attrs:{anchor:"bottom right",self:"bottom right",offset:[-10,35],"content-class":"bg-accent","content-style":"font-size: 12px"}},[a._v("\n              Pulsa el icono\n              "),o("q-icon",{attrs:{name:"fas fa-level-up-alt"}})],1)],1),o("q-select",{staticClass:"col-lg-2 col-md-2 col-sm-5 col-12 q-pa-sm",attrs:{outlined:"",options:a.opcionesSexo,label:"Sexo",color:"secondary"},model:{value:a.usuario.genero,callback:function(e){a.$set(a.usuario,"genero",e)},expression:"usuario.genero"}})],1)]),o("q-card-section",{staticClass:"q-mt-md"},[o("div",{staticClass:"text-h6 text-grey-6"},[a._v("\n          Dirección\n          "),o("q-icon",{attrs:{name:"far fa-address-card"}})],1),o("div",{staticClass:"row"},[o("q-input",{staticClass:" col-lg-7 col-md-7 col-sm-7 col-12 q-pa-sm",attrs:{outlined:"",label:"Calle",type:"text",color:"secondary"},scopedSlots:a._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-road"}})]},proxy:!0}]),model:{value:a.direccion.calle,callback:function(e){a.$set(a.direccion,"calle",e)},expression:"direccion.calle"}}),o("q-input",{staticClass:" col-lg-3 col-md-3 col-sm-3 col-12 q-pa-sm ",attrs:{outlined:"",label:"Número piso",type:"number",color:"secondary"},model:{value:a.direccion.numero,callback:function(e){a.$set(a.direccion,"numero",e)},expression:"direccion.numero"}})],1),o("div",{staticClass:"q-mb-md row"},[o("q-input",{staticClass:" col-lg-3 col-md-3 col-sm-3 col-12  q-pa-sm",attrs:{outlined:"",label:"Código postal",type:"number",color:"secondary"},model:{value:a.direccion.zip,callback:function(e){a.$set(a.direccion,"zip",e)},expression:"direccion.zip"}}),o("q-input",{staticClass:" col-lg-4 col-md-4 col-sm-4 col-12 q-pa-sm",attrs:{outlined:"",label:"Ciudad",type:"text",color:"secondary"},scopedSlots:a._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-city"}})]},proxy:!0}]),model:{value:a.direccion.ciudad,callback:function(e){a.$set(a.direccion,"ciudad",e)},expression:"direccion.ciudad"}}),o("q-input",{staticClass:" col-lg-3 col-md-3 col-sm-3 col-12 q-pa-sm",attrs:{outlined:"",label:"País",type:"text",color:"secondary"},scopedSlots:a._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"fas fa-globe-americas"}})]},proxy:!0}]),model:{value:a.direccion.pais,callback:function(e){a.$set(a.direccion,"pais",e)},expression:"direccion.pais"}})],1)]),o("q-card-actions",{staticClass:"q-pr-md q-pb-md",attrs:{align:"right"}},[o("q-btn",{attrs:{dense:"",outline:"",color:"green-9",label:"Guardar cambios"},on:{click:a.guardarInformacionPerfil}})],1)],1),"local"===this.usuario.modoInicioSesion?o("q-card",{staticClass:"q-mt-lg q-ma-sm"},[o("q-card-section",{staticClass:"flex"},[o("div",{staticClass:"text-h5"},[a._v("Seguridad")]),o("q-space"),o("q-icon",{staticClass:"cursor-pointer",staticStyle:{"font-size":"2em"},attrs:{name:"info",color:"secondary"}},[o("q-tooltip",{attrs:{"content-class":"bg-purple","content-style":"font-size: 13px",offset:[10,10]}},[a._v("\n            Para editar la informacion, modifica el campo que quieras modificar y despues pulsa 'Guardar'\n          ")])],1)],1),o("q-separator"),o("q-card-section",[o("div",{staticClass:"text-h6 text-grey-6"},[a._v("Modifcar contraseña")]),o("div",{staticClass:"row"},[o("q-input",{staticClass:"q-pa-sm col-lg-5 col-md-5 col-sm-5 col-12",attrs:{outlined:"",label:"Antigua contraseña",placeholder:"*******************",color:"secondary"},model:{value:a.contraseñas.old,callback:function(e){a.$set(a.contraseñas,"old",e)},expression:"contraseñas.old"}}),o("q-input",{staticClass:"q-pa-sm col-lg-5 col-md-5 col-sm-5 col-12",attrs:{outlined:"",label:"Nueva contraseña",placeholder:"*******************",color:"secondary"},model:{value:a.contraseñas.nueva,callback:function(e){a.$set(a.contraseñas,"nueva",e)},expression:"contraseñas.nueva"}})],1),o("div",{staticClass:"row"},[o("div",{staticClass:"q-pa-sm col-lg-5 col-md-5 col-sm-5 col-12"}),o("q-input",{staticClass:"q-pa-sm col-lg-5 col-md-5 col-sm-5 col-12",attrs:{outlined:"",label:"Repetir contraseña",placeholder:"*******************",color:"secondary",rules:[function(e){return a.contraseñas.nueva===a.contraseñas.nueva2||"Las contraseñas no coinciden"}]},model:{value:a.contraseñas.nueva2,callback:function(e){a.$set(a.contraseñas,"nueva2",e)},expression:"contraseñas.nueva2"}})],1)]),o("q-card-actions",{staticClass:"q-pr-md q-pb-md",attrs:{align:"right"}},[o("q-btn",{attrs:{dense:"",outline:"",color:"green-9",label:"Guardar cambios"},on:{click:a.guardarInfoSeguridad}})],1)],1):a._e()],1),o("div",{staticClass:"col-lg-4 col-md-4 col-sm-12 col-12 q-pa-lg column"},[o("q-card",{staticClass:"column  content-center q-ma-sm"},[o("q-card-section",{staticClass:"flex flex-center"},[o("div",{staticClass:"text-h6 text-grey-6"},[a._v("Fotografia de perfil")])]),o("q-card-section",{staticClass:"flex flex-center"},[o("q-avatar",{attrs:{size:"13em"}},[o("q-img",{attrs:{src:a.usuario.foto,ratio:1,alt:"Imagen de perfil del usuario","placeholder-src":"https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRr1v58ICPpgv8t4zeWFfmJqBre8Xedi8agxMpKEHR-G5L06sic","spinner-color":"primary"}})],1)],1),a.editarFoto?o("q-card-section",[o("q-uploader",{staticStyle:{"max-width":"240px"},attrs:{color:"indigo",label:"Arrastra o selecciona tu foto (MAX 10MB)","auto-upload":"",url:a.urlUploadProfileFoto,headers:[{name:"Authorization",value:a.tokenToUploadFoto}],method:"PUT","with-credentials":a.booleano,fieldName:"file","max-file-size":10485760},on:{uploaded:a.fotoSubida}})],1):a._e(),o("q-card-actions",{staticClass:"q-pr-md q-pb-md",attrs:{align:"center"}},[a.editarFoto?o("q-btn",{attrs:{outline:"",color:"negative",label:"Cancelar cambio",icon:"fas fa-ban"},on:{click:a.editFoto}}):a._e(),a.editarFoto?a._e():o("q-btn",{attrs:{flat:"",color:"secondary",label:"Cambiar foto",icon:"far fa-edit"},on:{click:a.editFoto}})],1)],1),o("q-btn",{staticClass:"q-ma-sm",attrs:{label:"Eliminar cuenta",color:"negative",outline:""},on:{click:function(e){a.borrarCuenta=!0}}})],1),o("q-dialog",{model:{value:a.borrarCuenta,callback:function(e){a.borrarCuenta=e},expression:"borrarCuenta"}},[o("q-card",{staticClass:"my-card"},[o("q-card-section",{staticClass:"q-pt-sm"},[o("div",{staticClass:"text-h6"},[a._v("\n          Eliminar cuenta\n        ")]),o("div",{staticClass:"text-subtitle2"},[a._v("\n          Introduce tu email para eliminar la cuenta\n        ")]),o("div",{staticClass:"text-grey-7"},[a._v("\n          Para verificar que esta acción es voluntaria te pedimos que\n          nos escribas tu correo electronico con el que estas registrado\n        ")])]),o("q-separator"),o("q-card-section",{},[o("q-input",{attrs:{outlined:"",dense:"",color:"secondary",placeholder:a.usuario.email,rules:[function(e){return null!=a.emailToDelete||"Campo requerido"},function(e){return""!==a.emailToDelete||"Campo requerido"}],"lazy-rules":""},model:{value:a.emailToDelete,callback:function(e){a.emailToDelete=e},expression:"emailToDelete"}}),o("div",{staticClass:"q-pt-md"},[a._v("\n          ¿Estas seguro de borrar tu cuenta?\n          Esta acción "),o("span",{staticClass:"text-negative text-weight-bolder"},[a._v("no se puede deshacer")]),a._v(".\n          Si en el futuro quieres volver a utilizar esta aplicacion, tendras que crearte otra cuenta.\n\n          "),o("div",{staticClass:"text-weight-bolder"},[a._v("\n            Perderas todos tus fichajes y se te desvinculara de tu empresa.\n          ")])])],1),o("q-separator"),o("q-card-actions",{attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"accent",label:"Cancelar"}}),a.usuario.email!==a.emailToDelete?o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",disable:"",color:"negative",label:"Borrar cuenta"}}):a._e(),a.usuario.email===a.emailToDelete?o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"negative",label:"Borrar cuenta"},on:{click:a.deleteAccount}}):a._e()],1)],1)],1)],1)},s=[],i=o("fa84"),r=o.n(i),c=(o("28a5"),o("a481"),o("967e")),n=o.n(c),l=o("c1df"),u={name:"Account",props:{usuarioLogged:{},direccionUsuario:{}},created:function(){var a=this;return r()(n.a.mark((function e(){var o,t;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.moment=l,e.next=3,a.$axiosJava.get("/private/usuario");case 3:o=e.sent,t=o.data,a.usuario.email=t.email,a.usuario.nombre=t.nombre,a.usuario.apellidos=t.apellidos,a.usuario.genero=t.genero,null!=t.dataNacimiento&&""!==t.dataNacimiento&&(a.usuario.dataNacimiento=t.dataNacimiento),null!=t.direccion&&""!==t.direccion&&a.parserDirection(t.direccion),a.usuario.modoInicioSesion=t.modoInicioSesion.toLowerCase(),a.usuario.foto=t.fotoPerfil;case 13:case"end":return e.stop()}}),e)})))()},data:function(){return{parserMoment:null,booleano:!0,emailToDelete:null,borrarCuenta:!1,urlUploadProfileFoto:"https://api.tresee.app/private/usuario/foto",tokenToUploadFoto:"",editarFoto:!1,modoInicioSesion:null,opcionesSexo:["HOMBRE","MUJER","INDEFINIDO"],usuario:{nombre:"",email:"",apellidos:"",direccion:"",dataNacimiento:"",genero:"",foto:""},"contraseñas":{old:"",nueva:"",nueva2:""},direccion:{calle:"",numero:null,zip:null,ciudad:"",pais:""}}},methods:{deleteAccount:function(){var a=this;return r()(n.a.mark((function e(){var o;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$axiosJava.delete("/private/usuario");case 2:if(o=e.sent,200!==o.status){e.next=11;break}return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("rol"),e.next=9,a.$router.push("/");case 9:e.next=12;break;case 11:a.mostrarNotificacion("No se ha podido eliminar tu cuenta");case 12:case"end":return e.stop()}}),e)})))()},editFoto:function(){this.editarFoto=!this.editarFoto,this.tokenToUploadFoto=localStorage.getItem("refreshToken")},fotoSubida:function(){var a=this;return r()(n.a.mark((function e(){var o;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.editarFoto=!1,e.next=3,a.$axiosJava.get("/private/usuario/foto");case 3:o=e.sent,200===o.status?(a.usuario.foto=o.data,a.updateInfoWithLayout()):a.mostrarNotificacion("No se ha podido recuperar tu imagen de perfil","red-9"),a.mostrarNotificacion("Se ha modificado la foto correctamente","green");case 6:case"end":return e.stop()}}),e)})))()},guardarInformacionPerfil:function(){var a=this;return r()(n.a.mark((function e(){var o;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.usuario.direccion=a.direccion.calle+", "+a.direccion.numero+", "+a.direccion.zip+", "+a.direccion.ciudad+", "+a.direccion.pais,null===a.usuario.genero&&(a.usuario.genero=" "),e.next=4,a.$axiosJava.put("/private/usuario",a.usuario);case 4:o=e.sent,200===o.status?(a.mostrarNotificacion("Se ha guardado la informacion correctamente","secondary"),a.updateInfoWithLayout()):a.mostrarNotificacion(o.data,"red-9");case 6:case"end":return e.stop()}}),e)})))()},guardarInfoSeguridad:function(){var a=this;return r()(n.a.mark((function e(){var o,t;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o={oldPassword:a.contraseñas.old,newPassword:a.contraseñas.nueva,newPassword1:a.contraseñas.nueva2},e.next=3,a.$axiosNode.put("/usuario/seguridad",o);case 3:t=e.sent,200===t.status?a.mostrarNotificacion("Se ha guardado la informacion correctamente","secondary"):a.mostrarNotificacion(t.statusText,"red-9");case 5:case"end":return e.stop()}}),e)})))()},parserDirection:function(a){var e=a.split(",");this.direccion.calle=e[0],this.direccion.numero=parseInt(e[1]),this.direccion.zip=parseInt(e[2]),e[3]&&(this.direccion.ciudad=e[3].replace(/\s/g,"")),e[4]&&(this.direccion.pais=e[4].replace(/\s/g,""))},mostrarNotificacion:function(a){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:indigo;this.$q.notify({color:e,message:a,position:"top-right",timeout:5e3})},updateInfoWithLayout:function(){this.usuarioLogged.nombre=this.usuario.nombre,this.usuarioLogged.apellidos=this.usuario.apellidos,this.usuarioLogged.foto=this.usuario.foto}}},d=u,p=o("2877"),m=o("9989"),f=o("f09f"),v=o("a370"),q=o("2c91"),g=o("0016"),b=o("05c0"),x=o("eb85"),h=o("27f9"),C=o("7cbe"),y=o("52ee"),k=o("ddd8"),w=o("4b7e"),N=o("9c40"),S=o("cb32"),_=o("068f"),I=o("ee89"),$=o("24e8"),P=o("7f67"),z=o("eebe"),D=o.n(z),F=Object(p["a"])(d,t,s,!1,null,"38b54979",null);e["default"]=F.exports;D()(F,"components",{QPage:m["a"],QCard:f["a"],QCardSection:v["a"],QSpace:q["a"],QIcon:g["a"],QTooltip:b["a"],QSeparator:x["a"],QInput:h["a"],QPopupProxy:C["a"],QDate:y["a"],QSelect:k["a"],QCardActions:w["a"],QBtn:N["a"],QAvatar:S["a"],QImg:_["a"],QUploader:I["a"],QDialog:$["a"]}),D()(F,"directives",{ClosePopup:P["a"]})}}]);