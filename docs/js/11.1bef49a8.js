(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"044e":function(a,t,e){"use strict";var s=e("b40d"),r=e.n(s);r.a},b40d:function(a,t,e){},d08f:function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("q-page",{staticClass:"row bg-imagen"},[e("div",{staticClass:"col-lg-8 col-md-12 col-sm-12  col-xs-12 col-12 q-pa-lg column  flex-center "},[a.graficoHoras.mostrar?a._e():e("q-card",{staticStyle:{width:"100%"}},[e("q-skeleton",{attrs:{height:"50vh",width:"100%"}})],1),a.graficoHoras.mostrar?e("chartLinea",{ref:"chartLinea",attrs:{"width-canvas-porcentaje":"100",labels:a.graficoHoras.labels,datasets:a.graficoHoras.datasets,title:a.graficoHoras.titulo,"height-canvas-porcentaje":"40"}}):a._e()],1),e("div",{staticClass:"col-lg-4 col-md-12 col-sm-12  col-xs-12 col-12 column  justify-center"},[a.mostrarTajetaEmpresa?a._e():e("q-card",{staticClass:"q-ma-md"},[e("q-skeleton",{attrs:{width:"100%",height:"23vh"}})],1),a.mostrarTajetaEmpresa?e("q-card",{staticClass:"q-ma-md "},[e("q-card-section",{staticClass:"q-pa-sm q-pl-md"},[e("q-item",{staticClass:"q-pa-none"},[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",{attrs:{square:"",size:"4.5em"}},[e("q-img",{attrs:{src:a.empresa.foto}})],1)],1),e("q-item-section",[e("q-item-label",{staticClass:"text-h5"},[a._v(" "+a._s(a.empresa.nombre||"No tienes empresa asignada"))]),e("q-item-label",{attrs:{caption:""}},[a._v(" Tu empresa de FCT")])],1)],1)],1),e("q-card-section",{staticClass:" q-pa-none "},[e("q-separator",{attrs:{spaced:"",inset:""}}),e("q-splitter",{scopedSlots:a._u([{key:"before",fn:function(){return[e("q-tabs",{staticClass:"text-secondary",attrs:{vertical:""},model:{value:a.tabEmpresa,callback:function(t){a.tabEmpresa=t},expression:"tabEmpresa"}},[e("q-tab",{attrs:{disable:null===a.empresa.nombre,ripple:!1,name:"Info",label:"Info"}}),e("q-tab",{attrs:{disable:null===a.empresa.nombre,ripple:!1,name:"Compañeros",label:"Estudiantes"}}),a.$q.screen.gt.xs?e("q-tab",{attrs:{disable:null===a.empresa.nombre,ripple:!1,name:"Horario",label:"Horario"}}):a._e()],1)]},proxy:!0},{key:"after",fn:function(){return[e("q-tab-panels",{attrs:{animated:"",vertical:"","transition-prev":"jump-up","transition-next":"jump-up"},model:{value:a.tabEmpresa,callback:function(t){a.tabEmpresa=t},expression:"tabEmpresa"}},[e("q-tab-panel",{staticClass:"column q-pa-none",attrs:{name:"Info"}},[null!==a.empresa.nombre?e("div",[e("div",{staticClass:"column items-center q-pa-xs"},[e("span",{staticClass:"text-h6"},[a._v("Contacto:")]),a._v(a._s(a.empresa.contacto)+"\n                  ")]),e("div",{staticClass:"column q-pa-xs items-center"},[e("span",{staticClass:"text-h6"},[a._v("Dirección:")]),a._v(" "+a._s(a.empresa.direccion)+"\n                  ")])]):a._e(),""===a.empresa.nombre?e("div"):a._e()]),e("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"Compañeros"}},[e("q-list",{staticStyle:{height:"15vh"}},a._l(a.empresa.estudiantes,(function(t){return e("q-item",{key:t.idusuario},[e("q-item-section",[e("q-item-label",[a._v(a._s(t.nombre)+" "+a._s(t.apellidos))]),e("q-item-label",{attrs:{caption:"",lines:"1"}},[a._v(a._s(t.email))])],1)],1)})),1)],1),a.$q.screen.gt.xs?e("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"Horario"}},[e("q-tabs",{staticClass:"text-grey",attrs:{"active-color":"secondary","indicator-color":"secondary",dense:""},model:{value:a.tabHorario,callback:function(t){a.tabHorario=t},expression:"tabHorario"}},a._l(a.empresa.horarios,(function(a){return e("q-tab",{attrs:{name:a.dia.dia,label:a.dia.dia.substring(0,3)}})})),1),e("q-separator"),e("q-tab-panels",{attrs:{animated:""},model:{value:a.tabHorario,callback:function(t){a.tabHorario=t},expression:"tabHorario"}},a._l(a.empresa.horarios,(function(t){return e("q-tab-panel",{attrs:{name:t.dia.dia}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-5 flex justify-end"},[a._v("\n                        Entrada\n                      ")]),e("div",{staticClass:"col-2"}),e("div",{staticClass:"col-5 flex"},[a._v("\n                        Salida\n                      ")])]),e("div",{staticClass:"row "},[e("div",{staticClass:"text-h6 flex justify-end text-weight-regular  col-5"},[a._v("\n                        "+a._s(a._f("filtroQuitarSegundoHoras")(t.horaEntrada))+"\n\n                      ")]),e("div",{staticClass:"text-h6 text-weight-regular col-2 flex flex-center"},[a._v("-")]),e("div",{staticClass:"text-h6 text-weight-regular  col-5 flex"},[a._v("\n                        "+a._s(a._f("filtroQuitarSegundoHoras")(t.horaSalida))+"\n\n                      ")])])])})),1)],1):a._e()],1)]},proxy:!0}],null,!1,1519569567),model:{value:a.splitterModel,callback:function(t){a.splitterModel=t},expression:"splitterModel"}})],1)],1):a._e(),a.graficoHoras.mostrar?a._e():e("q-card",{staticClass:"q-ma-md"},[e("q-skeleton",{attrs:{width:"100%",height:"23vh"}})],1),a.graficoHoras.mostrar?e("q-card",{staticClass:"q-ma-md "},[e("q-card-section",[e("q-item",{staticClass:"q-pa-none  "},[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",{attrs:{square:"",size:"4.5em",icon:"far fa-id-badge"}})],1),e("q-item-section",[e("q-item-label",{staticClass:"text-h5"},[a._v("Horas fichadas")])],1)],1)],1),e("q-card-section",{staticClass:"text-grey-9 q-pa-none flex flex-center text-weight-medium",staticStyle:{"font-size":"2em"}},[a._v("\n        "+a._s(a.horasTotalesFichadas)+"/400 Horas\n      ")]),e("q-card-actions",{},[a.horasTotalesFichadas<100?e("q-chip",{attrs:{square:"",color:"grey-7","text-color":"white",label:"Venga a trabajar, que aun te queda"}}):a._e(),a.horasTotalesFichadas>=100&&a.horasTotalesFichadas<300?e("q-chip",{attrs:{square:"",color:"amber-8","text-color":"white",label:"Así se hace, sigue así"}}):a._e(),a.horasTotalesFichadas>=300&&a.horasTotalesFichadas<400?e("q-chip",{attrs:{square:"",color:"blue","text-color":"white",label:"Va va, ya casi acabas"}}):a._e(),a.horasTotalesFichadas>=400?e("q-chip",{attrs:{square:"",color:"green","text-color":"white",label:"Ya has acabado, enhorabuena !"}}):a._e()],1)],1):a._e()],1)])},r=[],o=e("fa84"),i=e.n(o),n=(e("6d67"),e("d25f"),e("28a5"),e("967e")),l=e.n(n),c=e("33e7"),d={components:{chartLinea:c["a"]},name:"Dashboard",data:function(){return{mostrarTajetaEmpresa:!1,graficoHoras:{labels:[],datasets:[],titulo:"Todos los fichajes",mostrar:!1},horasTotalesFichadas:0,tabEmpresa:"Info",tabHorario:null,splitterModel:20,empresa:{nombre:"",contacto:"",direccion:"",foto:"",horarios:[],estduaintes:[]}}},created:function(){var a=this;return i()(l.a.mark((function t(){var e,s;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.$axiosJava.get("/private/my/empresa");case 2:if(e=t.sent,200!==e.status){t.next=15;break}return a.empresa.nombre=e.data.nombre,a.empresa.foto=e.data.fotoEmpresa,a.empresa.estudiantes=e.data.estudiantes,a.empresa.direccion=e.data.direccion,a.empresa.contacto=e.data.contacto,a.empresa.horarios=e.data.empresaTieneDias,null!=a.empresa.horarios&&a.empresa.horarios.length>0?(a.empresa.horarios=e.data.empresaTieneDias.sort((function(a,t){return a.dia.iddia-t.dia.iddia})),a.empresa.horarios.length>0&&(a.tabHorario=a.empresa.horarios[0].dia.dia),a.mostrarTajetaEmpresa=!0):a.mostrarTajetaEmpresa=!0,t.next=13,a.$axiosJava.get("/private/usuario");case 13:s=t.sent,200===s.status?a.createDataSet(s.data):a.mostrarNotificacion("Algo ha ido mal","red",!1,"bottom-left");case 15:case"end":return t.stop()}}),t)})))()},methods:{createDataSet:function(a){var t=this,e=[],s={data:[],label:"Horas fichadas",borderColor:"#1f8b92",backgroundColor:"rgba(123,233,115,0.21)",fill:!0},r=[];a.fichajes.map((function(a){if(a.horaEntrada&&a.horaSalida){var s=!1;e.forEach((function(t){t===a.diaFichaje&&(s=!0)}));var o={label:null,horasFichadas:null};if(s){var i=r.filter((function(t){return t.label===a.diaFichaje}));i=i[0],i.horasFichadas+=t.getDiffHoras(a.horaEntrada,a.horaSalida)}else e.push(a.diaFichaje),o.label=a.diaFichaje,o.horasFichadas=t.getDiffHoras(a.horaEntrada,a.horaSalida),r.push(o)}})),r.map((function(a){s.data.push(a.horasFichadas)}));var o=0;s.data.map((function(a){o+=parseFloat(a.toFixed(2))})),this.horasTotalesFichadas=parseFloat(o.toFixed(1)),this.graficoHoras.labels=e,this.graficoHoras.datasets=[],this.graficoHoras.datasets.push(s),this.graficoHoras.mostrar=!0},getDiffHoras:function(a,t){var e=a.split(":"),s=new Date;s.setHours(e[0]),s.setMinutes(e[1]),s.setSeconds(e[2]);var r=t.split(":"),o=new Date;return o.setHours(r[0]),o.setMinutes(r[1]),o.setSeconds(r[2]),parseFloat(((o-s)/1e3/3600).toFixed(2))},mostrarNotificacion:function(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"indigo",e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"top-right";this.$q.notify({color:t,message:a,position:s,timeout:5e3,multiLine:e})}},filters:{filtroQuitarSegundoHoras:function(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return a.substring(0,t)}}},m=d,p=(e("044e"),e("2877")),u=e("9989"),h=e("f09f"),f=e("293e"),b=e("a370"),q=e("66e5"),v=e("4074"),g=e("cb32"),x=e("068f"),_=e("0170"),C=e("eb85"),H=e("8562"),w=e("429b"),F=e("7460"),T=e("adad"),E=e("823b"),Q=e("1c1c"),S=e("4b7e"),j=e("b047"),y=e("eebe"),k=e.n(y),D=Object(p["a"])(m,s,r,!1,null,"ff88dab0",null);t["default"]=D.exports;k()(D,"components",{QPage:u["a"],QCard:h["a"],QSkeleton:f["a"],QCardSection:b["a"],QItem:q["a"],QItemSection:v["a"],QAvatar:g["a"],QImg:x["a"],QItemLabel:_["a"],QSeparator:C["a"],QSplitter:H["a"],QTabs:w["a"],QTab:F["a"],QTabPanels:T["a"],QTabPanel:E["a"],QList:Q["a"],QCardActions:S["a"],QChip:j["a"]})}}]);