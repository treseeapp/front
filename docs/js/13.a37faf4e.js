(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"1f25":function(a,t,s){},3716:function(a,t,s){"use strict";var e=s("1f25"),i=s.n(e);i.a},de45:function(a,t,s){"use strict";s.r(t);var e=function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("q-page",{staticClass:"row bg-imagen"},[s("div",{staticClass:"col-lg-8 col-md-8 col-sm-12 col-xs-12 col-12  q-pa-lg"},[s("q-card",{staticClass:"no-shadow bg-transparent"},[a.mostrarGraficoLineas?a._e():s("q-card-section",[s("q-skeleton",{attrs:{height:"60vh",animation:"wave"}})],1),a.mostrarGraficoLineas?s("q-card-section",{staticClass:"row"},[s("chartLinea",{ref:"chartLinea",staticClass:"no-border",attrs:{"width-canvas-porcentaje":"100",labels:a.graficoHorasEstudiantes.labels,datasets:a.graficoHorasEstudiantes.datasets,title:a.graficoHorasEstudiantes.titulo}}),s("q-btn",{staticClass:"absolute-top-right q-mt-lg q-mr-lg",attrs:{label:"Seleccionar estudiante",color:"green"},on:{click:a.reloadAndChangeDatasetHoras}},[s("q-menu",{attrs:{"transition-show":"jump-down","transition-hide":"jump-up"}},[s("q-list",{staticStyle:{"max-height":"400px"}},a._l(a.todosLosEstudiantes,(function(t){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(s){return a.changeDataSetStudentsHoursChart(t)}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",[s("q-img",{attrs:{src:t.foto,"placeholder-src":"https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRr1v58ICPpgv8t4zeWFfmJqBre8Xedi8agxMpKEHR-G5L06sic",ratio:1,"spinner-color":"primary"}})],1)],1),s("q-item-section",[a._v(a._s(t.nombre)+" "+a._s(t.apellidos))])],1)})),1)],1)],1)],1):a._e()],1)],1),s("div",{staticClass:"col-lg-4 col-md-4 col-sm-12 col-xs-12 col-12  q-pa-lg"},[s("q-card",{staticClass:"shadow-0 bg-transparent"},[s("q-card-section",[a.mostrarGraficoBarras?a._e():s("q-skeleton",{attrs:{height:"30vh",animation:"wave"}})],1),s("q-card-section",[a.mostrarGraficoBarras?s("barras-empresas-usuarios",{attrs:{title:a.graficoEstudiantesEmpresas.titulo,labels:a.graficoEstudiantesEmpresas.labels,datasets:a.graficoEstudiantesEmpresas.datasets,"width-canvas-porcentaje":"100"}}):a._e()],1),s("q-card-section",[s("q-table",{attrs:{"rows-per-page-options":[5],title:"Estudiantes",data:a.studentTable.data,columns:a.studentTable.columns,"row-key":"name","visible-columns":a.studentTable.visibleColumns},scopedSlots:a._u([{key:"top",fn:function(){return[s("img",{staticStyle:{height:"50px",width:"50px"},attrs:{src:"https://cdn.quasar.dev/logo/svg/quasar-logo.svg"}}),s("q-space"),s("q-select",{staticStyle:{"min-width":"150px"},attrs:{multiple:"",outlined:"",dense:"","options-dense":"","display-value":a.$q.lang.table.columns,"emit-value":"","map-options":"",options:a.studentTable.columns,"option-value":"name","options-cover":""},model:{value:a.studentTable.visibleColumns,callback:function(t){a.$set(a.studentTable,"visibleColumns",t)},expression:"studentTable.visibleColumns"}})]},proxy:!0}])})],1)],1)],1)])},i=[],r=s("fa84"),o=s.n(r),n=s("967e"),c=s.n(n),l=(s("6d67"),s("5df3"),s("06db"),s("cadf"),s("ac6a"),s("551c"),s("d25f"),s("28a5"),s("33e7")),d=s("7f10"),u={name:"Dashboard",data:function(){return{studentTable:{visibleColumns:["nombre","apellidos"],columns:[{name:"nombre",align:"left",label:"Nombre",field:"nombre",sortable:!0},{name:"apellidos",align:"center",label:"Apellidos",field:"apellidos",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0},{name:"dataNacimiento",label:"Fecha de nac",field:"dataNacimiento",sortable:!0}],data:[]},graficoEstudiantesEmpresas:{labels:[],datasets:[],titulo:"Estudiantes por empresa actuales"},graficoHorasEstudiantes:{labels:[],datasets:[],titulo:"Horas fichadas por dia"},mostrarGraficoBarras:!1,mostrarGraficoLineas:!1,todosLosEstudiantes:[],arrayColoresDistintos:["#3e95cd","#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd","#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd","#8e5ea2","#3cba9f","#e8c3b9","#c45850"]}},components:{chartLinea:l["a"],barrasEmpresasUsuarios:d["a"]},created:function(){var a=this;return o()(c.a.mark((function t(){var s,e,i;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.$axiosJava.get("/admin/empresas");case 2:return s=t.sent,200===s.status&&(e=s.data,i={data:[],label:"Estudiantes",backgroundColor:a.arrayColoresDistintos,fill:!1},e.map((function(t){a.graficoEstudiantesEmpresas.labels.push(t.nombre),i.data.push(t.estudiantes.length)})),a.graficoEstudiantesEmpresas.datasets.push(i),a.mostrarGraficoBarras=!0),t.next=6,a.cogerEstudiantes();case 6:a.todosLosEstudiantes.length>0&&a.changeDataSetStudentsHoursChart(a.todosLosEstudiantes[0]),a.studentTable.data=a.todosLosEstudiantes;case 8:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{cogerEstudiantes:function(){var a=this;return o()(c.a.mark((function t(){var s,e,i,r;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.$axiosJava.get("/admin/estudiantes");case 2:if(s=t.sent,200!==s.status){t.next=12;break}return e=[],s.data.forEach((function(t){e.push(a.$axiosJava.get("/admin/estudiantes/"+t.idusuario+"/foto"))})),t.next=8,Promise.all(e);case 8:i=t.sent,r=0,i.map((function(a){200===a.status&&(s.data[r].foto=a.data),r++})),a.todosLosEstudiantes=s.data;case 12:case"end":return t.stop()}}),t)})))()},changeDataSetStudentsHoursChart:function(a){var t=this,s=[],e={data:[],label:"Horas fichadas",borderColor:"#283592",backgroundColor:"rgba(233,67,122,0.21)",fill:!0},i=[];a.fichajes.map((function(a){if(a.horaEntrada&&a.horaSalida){var e=!1;s.forEach((function(t){t===a.diaFichaje&&(e=!0)}));var r={label:null,horasFichadas:null};if(e){var o=i.filter((function(t){return t.label===a.diaFichaje}));o=o[0],o.horasFichadas+=t.getDiffHoras(a.horaEntrada,a.horaSalida)}else s.push(a.diaFichaje),r.label=a.diaFichaje,r.horasFichadas=t.getDiffHoras(a.horaEntrada,a.horaSalida),i.push(r)}})),i.map((function(a){e.data.push(a.horasFichadas)}));var r=0;e.data.map((function(a){r+=parseFloat(a.toFixed(2))})),this.graficoHorasEstudiantes.titulo=a.nombre+" "+a.apellidos+" tiene "+r+" horas fichadas",this.graficoHorasEstudiantes.labels=s,this.graficoHorasEstudiantes.datasets=[],this.graficoHorasEstudiantes.datasets.push(e),this.mostrarGraficoLineas&&this.$refs.chartLinea.updateChart(this.graficoHorasEstudiantes.labels,this.graficoHorasEstudiantes.datasets,this.graficoHorasEstudiantes.titulo),this.mostrarGraficoLineas=!0},getDiffHoras:function(a,t){var s=a.split(":"),e=new Date;e.setHours(s[0]),e.setMinutes(s[1]),e.setSeconds(s[2]);var i=t.split(":"),r=new Date;return r.setHours(i[0]),r.setMinutes(i[1]),r.setSeconds(i[2]),parseFloat(((r-e)/1e3/3600).toFixed(2))},reloadAndChangeDatasetHoras:function(){this.cogerEstudiantes()}}},f=u,m=(s("3716"),s("2877")),p=s("9989"),h=s("f09f"),b=s("a370"),g=s("293e"),v=s("9c40"),E=s("4e73"),q=s("1c1c"),w=s("66e5"),C=s("4074"),H=s("cb32"),x=s("068f"),S=s("eaac"),L=s("2c91"),k=s("ddd8"),F=s("714f"),Q=s("eebe"),D=s.n(Q),y=Object(m["a"])(f,e,i,!1,null,"d274097c",null);t["default"]=y.exports;D()(y,"components",{QPage:p["a"],QCard:h["a"],QCardSection:b["a"],QSkeleton:g["a"],QBtn:v["a"],QMenu:E["a"],QList:q["a"],QItem:w["a"],QItemSection:C["a"],QAvatar:H["a"],QImg:x["a"],QTable:S["a"],QSpace:L["a"],QSelect:k["a"]}),D()(y,"directives",{Ripple:F["a"]})}}]);